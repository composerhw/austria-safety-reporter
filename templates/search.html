<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê²€ìƒ‰ | ì˜¤ìŠ¤íŠ¸ë¦¬ì•„ ì•ˆì „ ë‰´ìŠ¤</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <header>
        <div class="container">
            <h1>ğŸ” ë‰´ìŠ¤ ê²€ìƒ‰</h1>
            <div class="nav">
                <a href="index.html">í™ˆ</a>
                <a href="archive.html">ì•„ì¹´ì´ë¸Œ</a>
                <a href="search.html" class="active">ê²€ìƒ‰</a>
            </div>
        </div>
    </header>

    <div class="container">
        <input type="text" id="searchInput" class="search-box" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: ë¹„ì—”ë‚˜, ì‹œìœ„, ë‚ ì”¨)...">

        <div id="searchResults" class="card-grid">
            <!-- Results will appear here -->
        </div>
    </div>

    <footer>
        <div class="container">
            <p>&copy; {{ current_year }} Austria Safety Reporter</p>
        </div>
    </footer>

    <script>
        let archiveData = [];

        // Load archive data on page load
        fetch('data/archive.json')
            .then(response => response.json())
            .then(data => {
                archiveData = data;
                console.log('Loaded ' + archiveData.length + ' articles');
            })
            .catch(error => console.error('Error loading archive:', error));

        const searchInput = document.getElementById('searchInput');
        const resultsDiv = document.getElementById('searchResults');

        searchInput.addEventListener('input', (e) => {
            const query = e.target.value.toLowerCase().trim();

            if (query.length < 2) {
                resultsDiv.innerHTML = '<p style="text-align:center; color:#888;">2ê¸€ì ì´ìƒ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>';
                return;
            }

            const results = archiveData.filter(item => {
                const title = (item.title_ko || '').toLowerCase();
                const summary = (item.summary_ko || '').toLowerCase();
                const source = (item.source || '').toLowerCase();
                return title.includes(query) || summary.includes(query) || source.includes(query);
            });

            displayResults(results);
        });

        function displayResults(results) {
            if (results.length === 0) {
                resultsDiv.innerHTML = '<p style="text-align:center;">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }

            resultsDiv.innerHTML = results.map(item => `
                <article class="card">
                    <div class="meta">
                        <span class="source">${item.source}</span>
                        <span>${item.published}</span>
                    </div>
                    <h2>${item.title_ko}</h2>
                    <div class="summary">${item.summary_ko}</div>
                    <div class="actions">
                        <a href="${item.link}" target="_blank" class="btn-read">ì›ë¬¸ ë³´ê¸°</a>
                    </div>
                </article>
            `).join('');
        }
    </script>
</body>

</html>